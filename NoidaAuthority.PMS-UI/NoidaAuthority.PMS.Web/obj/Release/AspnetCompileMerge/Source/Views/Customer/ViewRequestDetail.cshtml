@using Kendo.Mvc.UI
@model NoidaAuthority.PMS.Entity.RequestDetails

@{
    ViewBag.Title = "ViewRequestDetails";
    Layout = "~/Views/Shared/_CustomerLayout.cshtml";
}



        <div class="col-lg-12 col-md-12 col-sm-12" style="padding-bottom:30px;">
            <div class="row" style="padding:0 10px 20px;">
                <div class="col-md-12 divPropertyDetailHeader">
                    <h4 class="inline">View Request Details</h4>
                </div>
            </div>
            @Html.Raw(ViewBag.gridDetails)
            @Html.HiddenFor(m => m.Id)
            @Html.HiddenFor(m => m.RId)
            @*<div class="row">
                <div class="col-md-12">
                    <div class="row">
                        <div class="col-md-3">@Html.Label("Request Number", new { @class = "nw-lbl-lft"})</div>
                        <div class="col-md-3">@Html.TextBoxFor(rd => rd.Id, new { @class = "nw-lbl-rht nw-txt-bx-spce", @readonly = "readonly" })</div>
                        <div class="col-md-3">@Html.Label("Registration ID", new { @class = "nw-lbl-lft" })</div>
                        <div class="col-md-3">@Html.TextBoxFor(rd => rd.RId, new { @class = "nw-lbl-rht nw-txt-bx-spce", @readonly = "readonly" })</div>
                    </div>
                    <div class="row">
                        <div class="col-md-3">@Html.Label("Service Name", new { @class = "nw-lbl-lft" })</div>
                        <div class="col-md-3">@Html.TextBoxFor(rd => rd.ServiceName, new { @class = "nw-lbl-rht nw-txt-bx-spce", @readonly = "readonly" })</div>
                        <div class="col-md-3">@Html.Label("Request Status", new { @class = "nw-lbl-lft" })</div>
                        <div class="col-md-3">@Html.TextBoxFor(rd => rd.ReqStatus, new { @class = "nw-lbl-rht nw-txt-bx-spce", @readonly = "readonly" })</div>
                    </div>
                    <div class="row">
                        <div class="col-md-3">@Html.Label("Description", new { @class = "nw-lbl-lft" })</div>
                        <div class="col-md-3">@Html.TextAreaFor(rd => rd.Description, new { @class = "nw-lbl-rht nw-txt-bx-spce", @readonly = "readonly" })</div>
                        <div class="col-md-3">@Html.Label("Comment", new { @class = "nw-lbl-lft" })</div>
                        <div class="col-md-3">@Html.TextAreaFor(rd => rd.Comment, new { @class = "nw-lbl-rht nw-txt-bx-spce" })</div>
                    </div>
                    <div class="row">
                        <div class="col-md-3">@Html.Label("Dues Amount", new { @class = "nw-lbl-lft" })</div>
                        <div class="col-md-3">@Html.TextBoxFor(rd => rd.DuesAmnt, new { @Value = "", @class = "nw-lbl-rht nw-txt-bx-spce" })</div>
                        <div class="col-md-3">@Html.Label("Service Fee", new { @class = "nw-lbl-lft" })</div>
                        <div class="col-md-3">@Html.TextBoxFor(rd => rd.ServiceFee, new { @Value = "", @class = "nw-lbl-rht nw-txt-bx-spce" })</div>
                    </div>
                    <div class="row">
                        <div class="col-md-3">@Html.Label("Payment Status", new { @class = "nw-lbl-lft" })</div>
                        <div class="col-md-3">@Html.TextBoxFor(rd => rd.PaymentStatus, new { @class = "nw-lbl-rht nw-txt-bx-spce", @readonly = "readonly" })</div>
                        <div class="col-md-3"></div>
                        <div class="col-md-3">@{
                            if (Model.ServiceFee > 0 || Model.DuesAmnt > 0)
                            {
                                <img src='~/Content/Images/Payment/paynow.jpg' width="120px" height="30px" />

                            }

                        }</div>
                    </div>
                </div>
            </div>*@
            
            @*<div class="inr-bx" style="border:solid #e2e3e4; border-width:0 1px 1px">
                <div class="form-bx">
                    <div class="row" style="padding-top:45px;">
                        <div class="col-md-3 col-sm-3 col-xs-12 col-for-label form-group">
                            
                        </div>
                        <div class="col-md-3 col-sm-3 col-xs-12 form-group">
                            
                        </div>
                        <div class="col-md-3 col-sm-3 col-xs-12 col-for-label  form-group">
                            
                        </div>
                        <div class="col-md-3 col-sm-3 col-xs-12 form-group">
                            
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-3 col-sm-3 col-xs-12 col-for-label form-group">
                            
                        </div>
                        <div class="col-md-3 col-sm-3 col-xs-12 form-group">
                            
                        </div>
                        <div class="col-md-3 col-sm-3 col-xs-12 col-for-label  form-group">
                            
                        </div>
                        <div class="col-md-3 col-sm-3 col-xs-12 form-group">
                            
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-3 col-sm-3 col-xs-12 col-for-label form-group">
                            
                        </div>
                        <div class="col-md-3 col-sm-3 col-xs-12 form-group">
                            
                        </div>
                        <div class="col-md-3 col-sm-3 col-xs-12 col-for-label  form-group">
                            
                        </div>
                        <div class="col-md-3 col-sm-3 col-xs-12 form-group">
                            
                        </div>

                    </div>
                    <div class="row">
                        <div class="col-md-3 col-sm-3 col-xs-12 col-for-label form-group">
                            
                        </div>
                        <div class="col-md-3 col-sm-3 col-xs-12 form-group">
                            
                        </div>
                        <div class="col-md-3 col-sm-3 col-xs-12 col-for-label  form-group">
                            
                        </div>
                        <div class="col-md-3 col-sm-3 col-xs-12 form-group">
                            
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-3 col-sm-3 col-xs-12 col-for-label form-group">
                            
                        </div>
                        <div class="col-md-3 col-sm-3 col-xs-12 form-group">
                            
                        </div>
                        <div class="col-md-3 col-sm-3 col-xs-12 col-for-label  form-group">

                        </div>
                        <div class="col-md-3 col-sm-3 col-xs-12 form-group">
                            
                        </div>
                    </div>
                </div>
            </div>*@


        </div>

        <div class="col-md-12 blnk-rw"></div>
        <div class="col-md-12 k-grid-content" style="padding:0 25px 0px 25px;">

    @(Html.Kendo().Grid<NoidaAuthority.PMS.Entity.CitizenPropertyDocument>()
                       .Name("gridDocuments")
              .Columns(columns =>
              {
                  columns.Bound(c => c.DocumentName).Title("Document Name").Width(80);
                  columns.Bound(c => c.DocumentPath).Hidden(true);
                  columns.Bound(c => c.DocumentPath).Width(150).ClientTemplate("<a style = 'cursor:pointer;' onclick=javascript:OpenFile(this);>View</a>").Width(80).Filterable(false);
              })
              .Sortable()
              .Filterable()
              .Resizable(resize => resize.Columns(true))
              .Pageable
              (
                       pageable => pageable
                      .Enabled(true)
                      .Refresh(true)
                      .PageSizes(true)
              )
              .DataSource
              (
                  dataSource => dataSource
                      .Ajax()
                      .Model(model => model.Id(p => p.RID))
                      .ServerOperation(true)
                      .Read(read => read.Action("GetDocumentDetails", "Customer").Data("AdditionalData"))
                      .PageSize(10)
              )
    )


</div>

        @(Html.Kendo().Window().Visible(false)
                   .Name("IDWindow").Width(920)
           .Title("Document")
           .Modal(true)
           .Content(@<text>
            <div style="width:100%" id="windowDiv">
                <iframe id="ifrmViewPdf" style="width:900px; height:500px;"></iframe>
            </div>
        </text>).Actions(actions => actions.Close())
        )

        <script type="text/javascript">


            function AdditionalData() {
                return {
                    rid: $('#RId').val(),
                    id: $("#Id").val()
                    //rid: 10000013,
                    //id: 1244
                };
            }

            function OpenFile(row) {
                $("#windowDiv").empty();
                var tr = $(row).parent().parent();
                var link = $(tr).children("td:eq(1)").text();
                $("#windowDiv").append($('<iframe src=' + link + ' style="width:900px; height:500px;"></iframe>'));
                $("#IDWindow").data("kendoWindow").center();
                $("#IDWindow").data("kendoWindow").open();
            }

            $(document).ready(function () {
                $("#btnSave").click(function () {
                    var serviceFee = $("#ServiceFee").val();
                    var duesAmnt = $("#DuesAmnt").val();
                    var comment = $("#Comment").val();
                    var id = $("#Id").val();
                    var tempVar = 1;
                    $.ajax({
                        dataType: 'json',
                        type: 'Post',
                        contentType: 'application/json; charset=utf-8',
                        data: JSON.stringify({ id: id, serviceFee: serviceFee, duesAmnt: duesAmnt, comment: comment, temp: tempVar }),
                        url: '/PropertyRegistration/SaveRequestDetails',
                        @*url: @Url.Action("SaveRequestDetails", "PropertyRegistration"),*@
                        success: function (result) {
                            if (result == true) {
                                alertify.success("Data saved successfully!");

                            }
                            else {
                                alertify.error("Some error occured. Please try again after some time");
                            }
                        },
                        error: function (obj) {
                            alertify.error("Some error occured. Please try again after some time");
                        }
                    });
                });

                $("#btnReject").click(function () {
                    var id = $("#Id").val();
                    var tempVar = 0;
                    $.ajax({
                        dataType: 'json',
                        type: 'Post',
                        contentType: 'application/json; charset=utf-8',
                        data: JSON.stringify({ id: id, temp: tempVar }),
                        url: '/PropertyRegistration/SaveRequestDetails',
                        @*url: @Url.Action("SaveRequestDetails", "PropertyRegistration"),*@
                        success: function (result) {
                            if (result == true) {
                                alertify.success("Data saved successfully!");

                            }
                            else {
                                alertify.error("Some error occured. Please try again after some time");
                            }
                        },
                        error: function (obj) {
                            alertify.error("Some error occured. Please try again after some time");
                        }
                    });
                });
            });
        </script>
